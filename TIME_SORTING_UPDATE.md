# â° æ—¶é—´æ’åºåŠŸèƒ½æ›´æ–°æ€»ç»“

## ğŸ¯ æ›´æ–°æ¦‚è¿°

æœ¬æ¬¡æ›´æ–°ä¸º SearXNG-SGA é¡¹ç›®æ·»åŠ äº†**è‡ªåŠ¨æ—¶é—´æ’åºåŠŸèƒ½**ï¼Œè®©æœç´¢ç»“æœæŒ‰å‘å¸ƒæ—¶é—´ä»æœ€æ–°åˆ°æœ€æ—§æ’åºï¼Œç¡®ä¿ç”¨æˆ·æ€»æ˜¯èƒ½è·å–åˆ°æœ€æ–°çš„ä¿¡æ¯ã€‚

## âœ¨ æ–°å¢åŠŸèƒ½

### 1. è‡ªåŠ¨æ—¶é—´æ’åº
- âœ… ç³»ç»Ÿè‡ªåŠ¨è·å–å½“å‰æ—¶é—´
- âœ… è§£ææœç´¢ç»“æœä¸­çš„ `publishedDate` å­—æ®µ
- âœ… æŒ‰å‘å¸ƒæ—¶é—´é™åºæ’åˆ—ï¼ˆæœ€æ–°å†…å®¹ä¼˜å…ˆï¼‰
- âœ… æ”¯æŒå¤šç§æ—¶é—´æ ¼å¼è§£æ
- âœ… æ²¡æœ‰æ—¶é—´ä¿¡æ¯çš„ç»“æœæ’åœ¨æœ€å

### 2. å¯é…ç½®æ’åºå‚æ•°
- âœ… æ–°å¢ `sort_by_time` å‚æ•°
- âœ… é»˜è®¤å¯ç”¨æ—¶é—´æ’åºï¼ˆ`true`ï¼‰
- âœ… å¯è®¾ç½®ä¸º `false` å…³é—­æ’åº
- âœ… æ”¯æŒçš„å€¼ï¼š`true`, `1`, `yes` æˆ– `false`, `0`, `no`

### 3. å¢å¼ºçš„æ—¥å¿—è®°å½•
- âœ… è®°å½•å½“å‰æ—¶é—´
- âœ… ç»Ÿè®¡æœ‰æ—¶é—´ä¿¡æ¯çš„ç»“æœæ•°é‡
- âœ… è®°å½•æ’åºå®ŒæˆçŠ¶æ€
- âœ… é”™è¯¯å¤„ç†å’Œè­¦å‘Šæ—¥å¿—

## ğŸ”§ æŠ€æœ¯å®ç°

### æ ¸å¿ƒå‡½æ•°
```python
def _sort_results_by_time(result_container):
    """æŒ‰æ—¶é—´å¯¹æœç´¢ç»“æœè¿›è¡Œæ’åºï¼ˆä»æœ€æ–°åˆ°æœ€æ—§ï¼‰"""
    # è·å–å½“å‰æ—¶é—´
    current_time = datetime.datetime.now()
    
    def get_sort_key(result):
        """è·å–æ’åºé”®å€¼"""
        # å°è¯•è·å–å‘å¸ƒæ—¶é—´
        published_date = None
        
        if hasattr(result, 'publishedDate') and result.publishedDate:
            published_date = result.publishedDate
        elif isinstance(result, dict) and result.get('publishedDate'):
            published_date = result['publishedDate']
        
        # è§£ææ—¶é—´æ ¼å¼
        if published_date:
            if isinstance(published_date, str):
                try:
                    published_date = datetime.datetime.fromisoformat(
                        published_date.replace('Z', '+00:00')
                    )
                except:
                    try:
                        published_date = datetime.datetime.strptime(
                            published_date, '%Y-%m-%d %H:%M:%S'
                        )
                    except:
                        published_date = None
            
            if published_date:
                return -published_date.timestamp()
        
        return 0
    
    # æ‰§è¡Œæ’åº
    if hasattr(result_container, 'results') and result_container.results:
        result_container.results.sort(key=get_sort_key)
```

### æ”¯æŒçš„APIæ¥å£
1. **`/chinese_search`** - ä¸­æ–‡æœç´¢APIï¼ˆæ¨èï¼‰
2. **`/wechat_search`** - å¾®ä¿¡æœç´¢API
3. **`/search`** - é€šç”¨æœç´¢APIï¼ˆä¿æŒå…¼å®¹æ€§ï¼‰

## ğŸ“Š åŠŸèƒ½å¯¹æ¯”

| ç‰¹æ€§ | æ›´æ–°å‰ | æ›´æ–°å |
|------|--------|--------|
| **æ—¶é—´æ’åº** | âŒ æ— æ’åº | âœ… è‡ªåŠ¨æ’åº |
| **æ’åºå‚æ•°** | âŒ æ— å‚æ•° | âœ… `sort_by_time` |
| **æ—¶é—´æ ¼å¼** | âŒ ä¸æ”¯æŒ | âœ… å¤šæ ¼å¼æ”¯æŒ |
| **æ—¥å¿—è®°å½•** | âŒ æ— è®°å½• | âœ… è¯¦ç»†æ—¥å¿— |
| **é”™è¯¯å¤„ç†** | âŒ åŸºç¡€å¤„ç† | âœ… å¢å¼ºå¤„ç† |

## ğŸš€ ä½¿ç”¨ç¤ºä¾‹

### åŸºæœ¬ä½¿ç”¨ï¼ˆé»˜è®¤å¯ç”¨æ’åºï¼‰
```bash
# ä¸­æ–‡æœç´¢ - è‡ªåŠ¨æŒ‰æ—¶é—´æ’åº
curl "http://localhost:8080/chinese_search?q=äººå·¥æ™ºèƒ½"

# å¾®ä¿¡æœç´¢ - è‡ªåŠ¨æŒ‰æ—¶é—´æ’åº
curl "http://localhost:8080/wechat_search?q=ChatGPT"
```

### é«˜çº§ä½¿ç”¨ï¼ˆå¯é…ç½®æ’åºï¼‰
```bash
# å…³é—­æ—¶é—´æ’åº
curl "http://localhost:8080/chinese_search?q=äººå·¥æ™ºèƒ½&sort_by_time=false"

# æŒ‡å®šè¿”å›æ¡æ•°
curl "http://localhost:8080/chinese_search?q=äººå·¥æ™ºèƒ½&limit=20&sort_by_time=true"

# æŒ‡å®šæœç´¢å¼•æ“
curl "http://localhost:8080/chinese_search?q=äººå·¥æ™ºèƒ½&engines=sogou,baidu&sort_by_time=true"
```

### Python è°ƒç”¨
```python
import requests

# é»˜è®¤å¯ç”¨æ—¶é—´æ’åº
response = requests.get('http://localhost:8080/chinese_search', {
    'q': 'äººå·¥æ™ºèƒ½',
    'limit': 10
})

# å…³é—­æ—¶é—´æ’åº
response = requests.get('http://localhost:8080/chinese_search', {
    'q': 'äººå·¥æ™ºèƒ½',
    'sort_by_time': False
})
```

## ğŸ”— Dify é›†æˆ

### é‡è¦æé†’
**åœ¨ Dify Docker ç¯å¢ƒä¸­ï¼Œå¿…é¡»ä½¿ç”¨ `host.docker.internal` åœ°å€ï¼**

```json
{
  "name": "chinese_search",
  "description": "ä¸­æ–‡æœç´¢å·¥å…·ï¼Œè‡ªåŠ¨æŒ‰æ—¶é—´æ’åº",
  "method": "GET",
  "url": "http://host.docker.internal:8888/chinese_search",
  "parameters": {
    "q": "{{query}}",
    "limit": "{{limit|default:10}}",
    "engines": "{{engines|default:sogou,baidu,360search,wechat}}",
    "sort_by_time": "{{sort_by_time|default:true}}"
  }
}
```

## ğŸ“ æ›´æ–°çš„æ–‡æ¡£

### 1. README_CN.md
- âœ… æ·»åŠ æ—¶é—´æ’åºåŠŸèƒ½è¯´æ˜
- âœ… æ›´æ–°APIç‰¹ç‚¹åˆ—è¡¨
- âœ… å¼ºè°ƒDify Dockerç¯å¢ƒé…ç½®è¦æ±‚
- âœ… æ›´æ–°åŠŸèƒ½å¯¹æ¯”è¡¨

### 2. README.rst
- âœ… æ·»åŠ æ—¶é—´æ’åºåŠŸèƒ½ç‰¹æ€§
- âœ… æ›´æ–°APIç«¯ç‚¹è¯´æ˜
- âœ… å¼ºè°ƒhost.docker.internalé…ç½®
- âœ… æ·»åŠ ä½¿ç”¨ç¤ºä¾‹

### 3. API_USAGE_GUIDE.md
- âœ… æ·»åŠ æ—¶é—´æ’åºå‚æ•°è¯´æ˜
- âœ… æ›´æ–°ä½¿ç”¨ç¤ºä¾‹
- âœ… æ›´æ–°Difyå·¥å…·é…ç½®
- âœ… æ·»åŠ æ€§èƒ½ä¼˜åŒ–å»ºè®®

## ğŸ¯ æŠ€æœ¯ç»†èŠ‚

### æ—¶é—´æ ¼å¼æ”¯æŒ
- ISO 8601: `2024-01-15T10:30:00Z`
- æ ‡å‡†æ ¼å¼: `2024-01-15 10:30:00`
- è‡ªåŠ¨è§£æå¤šç§æ ¼å¼

### æ’åºé€»è¾‘
1. æå– `publishedDate` å­—æ®µ
2. è§£ææ—¶é—´æ ¼å¼
3. è½¬æ¢ä¸ºæ—¶é—´æˆ³
4. æŒ‰è´Ÿæ—¶é—´æˆ³æ’åºï¼ˆæœ€æ–°åœ¨å‰ï¼‰
5. æ— æ—¶é—´ä¿¡æ¯çš„ç»“æœæ’åˆ°æœ€å

### é”™è¯¯å¤„ç†
- æ—¶é—´è§£æå¤±è´¥æ—¶è·³è¿‡è¯¥ç»“æœ
- è®°å½•è­¦å‘Šæ—¥å¿—
- ä¸å½±å“å…¶ä»–ç»“æœçš„æ’åº

## ğŸ”„ å‘åå…¼å®¹æ€§

- âœ… æ‰€æœ‰ç°æœ‰APIä¿æŒå…¼å®¹
- âœ… é»˜è®¤å¯ç”¨æ’åºï¼Œä¸å½±å“ç°æœ‰è°ƒç”¨
- âœ… å¯é€šè¿‡å‚æ•°å…³é—­æ’åº
- âœ… ä¸å½±å“ç½‘é¡µç•Œé¢åŠŸèƒ½

## ğŸ“ˆ æ€§èƒ½å½±å“

- âœ… æ’åºæ“ä½œè½»é‡çº§ï¼Œå½±å“å¾®ä¹å…¶å¾®
- âœ… å¯é€šè¿‡ `sort_by_time=false` å…³é—­æ’åºæå‡æ€§èƒ½
- âœ… æ™ºèƒ½æ—¶é—´è§£æï¼Œé¿å…æ— æ•ˆæ“ä½œ
- âœ… è¯¦ç»†çš„æ€§èƒ½æ—¥å¿—è®°å½•

## ğŸ‰ æ€»ç»“

æœ¬æ¬¡æ›´æ–°ä¸º SearXNG-SGA é¡¹ç›®æ·»åŠ äº†å¼ºå¤§çš„æ—¶é—´æ’åºåŠŸèƒ½ï¼Œè®©ç”¨æˆ·èƒ½å¤Ÿï¼š

1. **è·å–æœ€æ–°å†…å®¹** - è‡ªåŠ¨æŒ‰æ—¶é—´æ’åºï¼Œæœ€æ–°ä¿¡æ¯ä¼˜å…ˆ
2. **çµæ´»é…ç½®** - å¯é€‰æ‹©å¯ç”¨æˆ–å…³é—­æ—¶é—´æ’åº
3. **å®Œç¾é›†æˆ** - ä¸Difyç­‰AIå¹³å°å®Œç¾å…¼å®¹
4. **æ€§èƒ½ä¼˜åŒ–** - è½»é‡çº§å®ç°ï¼Œä¸å½±å“å“åº”é€Ÿåº¦

ç°åœ¨ç”¨æˆ·å¯ä»¥é€šè¿‡æˆ‘ä»¬çš„APIè·å–åˆ°æœ€æ–°ã€æœ€ç›¸å…³çš„ä¸­æ–‡æœç´¢ç»“æœï¼ 